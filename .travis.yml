language: c++
compiler: gcc-6

dist: trusty
sudo: required

install:
  - cd $HOME
  - wget https://cmake.org/files/v3.8/cmake-3.8.0-Linux-x86_64.tar.gz -O cmake-linux.tgz
  - tar xaf cmake-linux.tgz
  - mv cmake-*-x86_64 cmake
  - mkdir -p $HOME/bin
  - ln -s $HOME/cmake/bin/cmake $HOME/bin
  -  echo 'deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main' | sudo tee /etc/apt/sources.list.d/llvm.list
  - sudo apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 1397BC53640DB551
  - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  - sudo add-apt-repository --yes ppa:beineri/opt-qt58-trusty
#    sudo add-apt-repository --yes ppa:jonathonf/gcc-6.3
  - sudo apt-get update -qq
  - sudo apt-get install -qq --yes --force-yes g++-6 binutils ninja-build gcovr lcov qt58-meta-minimal libasound2-dev clang-4.0 lld-4.0 libavahi-client-dev libavahi-compat-libdnssd-dev
  - sudo rm /usr/bin/gcc /usr/bin/g++
  - sudo ln -s /usr/bin/gcc-6 /usr/bin/gcc
  - sudo ln -s /usr/bin/g++-6 /usr/bin/g++
  - wget http://openframeworks.cc/versions/v0.9.8/of_v0.9.8_linux64_release.tar.gz
  - tar -xf of_v0.9.8_linux64_release.tar.gz
  - sudo of_v0.9.8_linux64_release/scripts/linux/ubuntu/install_dependencies.sh -y
  - of_v0.9.8_linux64_release/scripts/linux/compileOF.sh -j 8
  - cd of_v0.9.8_linux64_release/addons
  - git clone --depth=1 https://github.com/OSSIA/ofxOSSIA.git
  - cd ofxOSSIA/libs
  - ./build.sh

script:
  - cd $HOME/of_v0.9.8_linux64_release/addons/ofxOSSIA/example-simple
  - make -j 4
